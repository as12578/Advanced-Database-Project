# Test 3.7
# T1 should not abort because site 4 did not fail.
# In this case, T1 will write to x4 on every site.
# x8 will not value 88 because T2 aborts
# the correct value right away but must wait for a write to take place.
# So W(T2,x8,88)
# will not commit and is lost on failure.
# Even though site 2 recovers before T2, T2 will not retroactively
# write to the site (in any practical version of available copies).
# T2 aborts because it wrote to x8.
begin(T1)

begin(T2)

R(T1,x3)
T1 - x3: 30

W(T2,x8,88)

fail(2)

R(T2,x3)

recover(2)

W(T1, x4,91)

end(T2)
T2 aborts

end(T1)
{'T1': {'readOnly': False, 'pendingOperation': {'operation': <Operation.NONE: 0>, 'options': {}}, 'startTime': 1, 'locks': {'x3': {'4': {'firstGrant': 3, 'lockType': <LockType.SHARED: 1>}}, 'x4': {'1': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '2': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '3': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '4': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '5': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '6': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '7': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '8': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '9': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}, '10': {'firstGrant': 8, 'lockType': <LockType.EXCLUSIVE: 2>}}}, 'failed': False}}
defaultdict(<class 'list'>, {'T1': [' '], 'x3.4': ['T1'], 'x4.1': ['T1'], 'x4.2': ['T1'], 'x4.3': ['T1'], 'x4.4': ['T1'], 'x4.5': ['T1'], 'x4.6': ['T1'], 'x4.7': ['T1'], 'x4.8': ['T1'], 'x4.9': ['T1'], 'x4.10': ['T1']})
Cycle? False
T1 commits


=============================System State=============================
Current Time = 10

=========================Current Transactions=========================
======================================================================

============================All Site State============================
Site: 1
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 2
Start Time: 7
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x1: :10:0
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x11: :110:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 3
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 4
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x3: :30:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x13: :130:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 5
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 6
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x5: :50:0
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x15: :150:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 7
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 8
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x7: :70:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x17: :170:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 9
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x20: :200:0
Pending Operations:


Site: 10
Start Time: 0
Available: True
Granted Locks:
	
Waiting Locks:
	
All Data:
	x2: :20:0
	x4: :40:0 T1:91:10
	x6: :60:0
	x8: :80:0
	x9: :90:0
	x10: :100:0
	x12: :120:0
	x14: :140:0
	x16: :160:0
	x18: :180:0
	x19: :190:0
	x20: :200:0
Pending Operations:


======================================================================
======================================================================
